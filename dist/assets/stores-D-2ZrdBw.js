import{d as e}from"./pinia-vendor-D_zwxMF-.js";import{s as a,n as t,o as l,t as o,l as n,r,b as i,e as s,c as u,d}from"./vendor-EN_QrI4H.js";import{r as c,c as v,w as m}from"./vue-vendor-DKeBeTOX.js";const h=a().length(3,"Country code must be exactly 3 characters"),g=t().int().min(1960).max(2030),p=t().positive("Value must be positive"),f=t().min(0).max(100);t().min(-180).max(180);const y=t().min(-90).max(90),b=t().min(-180).max(180);l({type:n("Point"),coordinates:o([b,y])});const w=l({type:n("Feature"),properties:r(i()),geometry:l({type:s(["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"]),coordinates:i()})}),x=l({type:n("FeatureCollection"),features:u(w)});l({area_code:h,area:a().min(1,"Area name is required"),item_code:t().int().positive(),item:a().min(1,"Item name is required"),element_code:t().int().positive(),element:a().min(1,"Element name is required"),year:g,unit:a().min(1,"Unit is required"),value:t().nullable(),flag:a().optional()});const D=l({year:g,production:t().nullable().optional(),imports:t().nullable().optional(),exports:t().nullable().optional(),domestic_supply:t().nullable().optional(),feed:t().nullable().optional(),food:t().nullable().optional(),other_uses:t().nullable().optional(),processing:t().nullable().optional(),seed:t().nullable().optional(),stock_variation:t().nullable().optional(),total_supply:t().nullable().optional()}),M=l({country:a().min(1,"Country is required"),item:a().min(1,"Item is required"),unit:a().min(1,"Unit is required"),data:u(D)}),C=u(M);l({country:a().min(1,"Country is required"),country_code:h,item:a().min(1,"Item is required"),year:g,production:p.nullable(),area_harvested:p.nullable(),yield:p.nullable()}),l({region:a().min(1,"Region is required"),item:a().min(1,"Item is required"),year:g,predicted_value:t(),confidence_interval:l({lower:t(),upper:t()}),model_accuracy:f,last_updated:a().datetime()}),l({query:a().min(1,"Search query is required").max(100,"Query too long"),filters:l({countries:u(h).optional(),items:u(a()).optional(),years:l({start:g,end:g}).refine(e=>e.start<=e.end,{message:"Start year must be before or equal to end year"}).optional()}).optional()}),l({format:s(["csv","json","xlsx"],"Invalid export format"),data_type:s(["production","trade","prices","forecast"],"Invalid data type"),filters:l({countries:u(h).min(1,"At least one country must be selected"),years:l({start:g,end:g}).refine(e=>e.start<=e.end,{message:"Start year must be before or equal to end year"}),items:u(a()).min(1,"At least one item must be selected")})}),l({theme:s(["light","dark","auto"]).default("auto"),language:s(["en","es","fr","de"]).default("en"),default_view:s(["dashboard","timeseries","map"]).default("dashboard"),chart_settings:l({animation_duration:t().min(0).max(5e3).default(750),show_tooltips:d().default(!0),show_legend:d().default(!0),color_scheme:s(["default","colorblind","high_contrast"]).default("default")}).default({}),data_settings:l({cache_duration:t().min(300).max(86400).default(3600),auto_refresh:d().default(!1),download_quality:s(["low","medium","high"]).default("medium")}).default({})}),l({success:d(),data:i().optional(),error:l({code:a(),message:a(),details:i().optional()}).optional(),metadata:l({timestamp:a().datetime(),version:a(),total_records:t().int().min(0).optional(),page:t().int().min(1).optional(),limit:t().int().min(1).optional()}).optional()});const S=async(e,a)=>{try{return{success:!0,data:await e.parseAsync(a),errors:null}}catch(t){return{success:!1,data:null,errors:t.errors||[{message:t.message}]}}};const I=new class{constructor(){this.cache=new Map,this.baseUrl="",this.validationEnabled=!0}async loadData(e,a=null,t=null,l={}){const o=a||e,{validateResponse:n=this.validationEnabled,throwOnValidationError:r=!1}=l;if(this.cache.has(o))return this.cache.get(o);try{const a=await fetch(e);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(t&&n){const e=await S(t,l);if(e.success)l._validation={valid:!0,errors:null,timestamp:(new Date).toISOString()};else{if(r)throw new Error(`Data validation failed: ${e.errors.map(e=>e.message).join(", ")}`);l._validation={valid:!1,errors:e.errors,timestamp:(new Date).toISOString()}}}return this.cache.set(o,l),l}catch(i){throw i}}async validateCachedData(e,a){if(!this.cache.has(e))throw new Error(`No cached data found for key: ${e}`);const t=this.cache.get(e);return await S(a,t)}setValidationEnabled(e){this.validationEnabled=e}async loadDataIndex(){return this.loadData("/data/index.json","main-index")}async loadFAOIndex(){return this.loadData("/data/fao/index.json","fao-index")}async loadFAOMetadata(){return this.loadData("/data/fao/metadata.json","fao-metadata")}async loadGeoData(e="geo"){const a={world:"/data/geo.json",world_simplified:"/data/geo.json",geo:"/data/geo.json"},t=a[e]||a.geo;return this.loadData(t,`geo-${e}`,x,{throwOnValidationError:!1})}async loadProductionData(e,a){const t=`/data/fao/geo/${`${e}_production_${a}.json`}`;return this.loadData(t,`production-${e}-${a}`)}async loadMLForecast(e){const a=e.replace(".json",""),t=`/data/fao/ml/${a}.json`;return this.loadData(t,`ml-${a}`)}async loadTimeseriesData(){return this.loadData("/data/fao/timeseries.json","timeseries",C,{throwOnValidationError:!1})}async loadProductionRankings(){return this.loadData("/data/fao/production_rankings.json","production-rankings")}async loadTradeBalance(){return this.loadData("/data/fao/trade_balance.json","trade-balance")}async loadNetworkData(){return this.loadData("/data/fao/network.json","network")}async loadSummaryData(){return this.loadData("/data/fao/summary.json","summary")}async loadMLIndex(){return this.loadData("/data/fao/ml/index.json","ml-index")}async loadMLComprehensiveIndex(){return this.loadData("/data/fao/ml/comprehensive_index.json","ml-comprehensive-index")}async loadMLGlobalIndex(){return this.loadData("/data/fao/ml/global_forecasts_index.json","ml-global-index")}async loadMLRegionalIndex(){return this.loadData("/data/fao/ml/regional_forecasts_index.json","ml-regional-index")}async loadMLCountryIndex(){return this.loadData("/data/fao/ml/country_forecasts_index.json","ml-country-index")}async getAvailableProducts(){return(await this.loadDataIndex()).products||[]}async getAvailableYears(){return(await this.loadDataIndex()).years||[]}clearCache(){this.cache.clear()}getCacheStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}},P=e("data",()=>{const e=c(null),a=c(new Map),t=c(new Map),l=c(null),o=c(null),n=c(null),r=c(null),i=c(null),s=c(null),u=c(null),d=c(null),h=c(null),g=c(null),p=c("maize_and_products"),f=c("global"),y=c({start:2018,end:2023}),b=c({countries:[],elements:[],items:[]}),w=c([]);c(new Map);const x=c(null),D=c(!1),M=c(new Map),C=c(new Map),S=v(()=>D.value),P=v(()=>null!==e.value),k=v(()=>Object.keys(a.value).length>0||w.value.length>0),_=v(()=>k.value),z=v(()=>w.value.length?w.value.filter(e=>!(e.Year<y.value.start||e.Year>y.value.end)&&(!(b.value.countries.length>0&&!b.value.countries.includes(e.Area))&&(!(b.value.elements.length>0&&!b.value.elements.includes(e.Element))&&!(b.value.items.length>0&&!b.value.items.includes(e.Item))))):[]),E=v(()=>{const e={};return z.value.forEach(a=>{e[a.Item]||(e[a.Item]=[]),e[a.Item].push(a)}),e}),L=v(()=>{const e={};return z.value.forEach(a=>{e[a.Area]||(e[a.Area]=[]),e[a.Area].push(a)}),e}),j=v(()=>{var e,a,t;if(l.value&&Object.keys(l.value).length>0)return Object.keys(l.value).sort();if(null==(a=null==(e=i.value)?void 0:e.data_summary)?void 0:a.food_items)return i.value.data_summary.food_items.sort();const o=(null==(t=r.value)?void 0:t.products)||[],n=[...new Set(w.value.map(e=>e.Item))].sort();return n.length>0?n:o}),F=v(()=>[...new Set(w.value.map(e=>e.Area))].sort()),A=v(()=>{var e;const a=(null==(e=r.value)?void 0:e.years)||[],t=[...new Set(w.value.map(e=>e.Year))].sort();return t.length>0?t:a}),O=v(()=>{if(!z.value.length)return null;const e=z.value.map(e=>parseFloat(e.Value)).filter(e=>!isNaN(e));if(!e.length)return null;const a=e.reduce((e,a)=>e+a,0),t=a/e.length,l=Math.min(...e),o=Math.max(...e);return{count:e.length,sum:a,average:t,min:l,max:o,median:e.sort((e,a)=>e-a)[Math.floor(e.length/2)]}}),T=(e,a)=>{M.value.set(e,a),D.value=Array.from(M.value.values()).some(Boolean)},V=(e,a)=>{C.value.set(e,a)},R=async()=>{const e="data-index";T(e,!0);try{const a=await I.loadDataIndex();return r.value=a,C.value.delete(e),a}catch(a){throw V(e,a.message),a}finally{T(e,!1)}},Y=async()=>{const e="fao-metadata";T(e,!0);try{const a=await I.loadFAOMetadata();return i.value=a,C.value.delete(e),a}catch(a){throw V(e,a.message),a}finally{T(e,!1)}},$=async(a="geo")=>{const t=`geo-${a}`;T(t,!0);try{const l=await I.loadGeoData(a);return e.value=l,C.value.delete(t),l}catch(l){throw V(t,l.message),l}finally{T(t,!1)}},q=async e=>{const a=`forecast-${e}`;T(a,!0);try{const l=await I.loadMLForecast(e);return t.value.set(a,l),C.value.delete(a),l}catch(l){throw V(a,l.message),l}finally{T(a,!1)}},N=q,G=async()=>{const e="timeseries";T(e,!0);try{const a=await I.loadTimeseriesData(),t={};return Array.isArray(a)&&a.forEach(e=>{const{item:a,country:l,data:o}=e;t[a]||(t[a]={}),t[a][l]=o}),l.value=t,C.value.delete(e),t}catch(a){throw V(e,a.message),a}finally{T(e,!1)}},U=e=>E.value[e]||[];return m([p,f],()=>{_.value}),{geoData:e,productionData:a,forecastData:t,timeseriesData:l,networkData:o,summaryData:n,dataIndex:r,faoMetadata:i,loading:D,errors:C,mlIndex:s,mlComprehensiveIndex:u,mlGlobalIndex:d,mlRegionalIndex:h,mlCountryIndex:g,selectedProduct:p,selectedRegion:f,selectedYears:y,dataFilters:b,currentData:w,lastUpdated:x,isLoading:S,hasGeoData:P,hasData:k,isDataLoaded:_,filteredData:z,dataByProduct:E,dataByRegion:L,availableProducts:j,availableRegions:F,availableYears:A,dataStats:O,loadDataIndex:R,loadFAOMetadata:Y,loadGeoData:$,loadProductionData:async(e,t)=>{const l=`production-${e}-${t}`;T(l,!0);try{const o=await I.loadProductionData(e,t);return a.value.set(l,o),C.value.delete(l),o}catch(o){throw V(l,o.message),o}finally{T(l,!1)}},loadForecastData:q,loadMLForecast:N,loadTimeseriesData:G,loadNetworkData:async()=>{const e="network";T(e,!0);try{const a=await I.loadNetworkData();return o.value=a,C.value.delete(e),a}catch(a){throw V(e,a.message),a}finally{T(e,!1)}},loadSummaryData:async()=>{const e="summary";T(e,!0);try{const a=await I.loadSummaryData();return n.value=a,C.value.delete(e),a}catch(a){throw V(e,a.message),a}finally{T(e,!1)}},initializeApp:async()=>{try{await R(),await Y(),await $("geo"),await G()}catch(e){}},getProductionData:(e,t)=>{const l=`production-${e}-${t}`;return a.value.get(l)},getForecastData:e=>{const a=`forecast-${e}`;return t.value.get(a)},clearCache:()=>{a.value.clear(),t.value.clear(),C.value.clear(),M.value.clear(),I.clearCache()},getError:e=>C.value.get(e),isLoadingData:e=>M.value.get(e)||!1,loadMLIndex:async()=>{const e="ml-index";T(e,!0);try{const a=await I.loadMLIndex();return s.value=a,C.value.delete(e),a}catch(a){throw V(e,a.message),a}finally{T(e,!1)}},loadMLComprehensiveIndex:async()=>{const e="ml-comprehensive-index";T(e,!0);try{const a=await I.loadMLComprehensiveIndex();return u.value=a,C.value.delete(e),a}catch(a){throw V(e,a.message),a}finally{T(e,!1)}},loadMLGlobalIndex:async()=>{const e="ml-global-index";T(e,!0);try{const a=await I.loadMLGlobalIndex();return d.value=a,C.value.delete(e),a}catch(a){throw V(e,a.message),a}finally{T(e,!1)}},loadMLRegionalIndex:async()=>{const e="ml-regional-index";T(e,!0);try{const a=await I.loadMLRegionalIndex();return h.value=a,C.value.delete(e),a}catch(a){throw V(e,a.message),a}finally{T(e,!1)}},loadMLCountryIndex:async()=>{const e="ml-country-index";T(e,!0);try{const a=await I.loadMLCountryIndex();return g.value=a,C.value.delete(e),a}catch(a){throw V(e,a.message),a}finally{T(e,!1)}},getAvailableMLForecasts:(e="all")=>{var a,t,l,o;switch(e){case"global":return(null==(a=d.value)?void 0:a.forecasts)||[];case"regional":return(null==(t=h.value)?void 0:t.forecasts)||[];case"country":return(null==(l=g.value)?void 0:l.forecasts)||[];default:return(null==(o=u.value)?void 0:o.forecast_categories)||{}}},setSelectedProduct:e=>{p.value=e},setSelectedRegion:e=>{f.value=e},setSelectedYears:e=>{y.value={...e}},setDataFilters:e=>{b.value={...e}},addCountryFilter:e=>{b.value.countries.includes(e)||b.value.countries.push(e)},removeCountryFilter:e=>{const a=b.value.countries.indexOf(e);a>-1&&b.value.countries.splice(a,1)},clearFilters:()=>{b.value={countries:[],elements:[],items:[]}},transformDataForVisualization:(e="timeseries")=>{if(!z.value.length)return[];switch(e){case"timeseries":return z.value.map(e=>({date:new Date(e.Year,0,1),value:parseFloat(e.Value)||0,year:e.Year,country:e.Area,product:e.Item,element:e.Element}));case"geographic":return z.value.reduce((e,a)=>{const t=a.Area;return e[t]||(e[t]={country:t,total:0,items:[]}),e[t].total+=parseFloat(a.Value)||0,e[t].items.push(a),e},{});case"comparative":return j.value.map(e=>{const a=E.value[e]||[];return{product:e,value:a.reduce((e,a)=>e+(parseFloat(a.Value)||0),0),count:a.length}});default:return z.value}},getDataForProduct:U,getDataForRegion:e=>L.value[e]||[],getTrendData:(e,a=null)=>{let t=U(e);return a&&(t=t.filter(e=>e.Area===a)),t.sort((e,a)=>e.Year-a.Year).map(e=>({year:e.Year,value:parseFloat(e.Value)||0}))},getTimeseriesDataForProduct:(e,a=null)=>{if(!l.value||!l.value[e])return null;const t=l.value[e];if(a){const e={};return Object.entries(t).forEach(([t,l])=>{const o=l.find(e=>e.year===a);o&&(e[t]=o)}),e}return t},getAvailableCountriesForProduct:e=>l.value&&l.value[e]?Object.keys(l.value[e]).sort():[],getAvailableYearsForProduct:e=>{if(!l.value||!l.value[e])return[];const a=new Set;return Object.values(l.value[e]).forEach(e=>{e.forEach(e=>a.add(e.year))}),Array.from(a).sort((e,a)=>e-a)},syncCurrentData:e=>{w.value=e,x.value=new Date}}}),k=e("ui",()=>{const e=c("light"),a=c(!1),t=c("dashboard"),l=c("dashboard"),o=c(""),n=c("Wheat and products"),r=c("production"),i=c(2022),s=c(!1),u=c(1),d=c([0,0]),m=c(!1),h=c([]),g=c([]),p=c(!1),f=c({}),y=c({}),b=c("overview"),w=c("default"),x=c(!1),D=c(!1),M=c([]),C=c("/"),S=c([]),I=c({dashboard:{visible:!0,minimized:!1,expanded:!0,loading:!1,error:null},timeseries:{visible:!1,minimized:!1,expanded:!0,loading:!1,error:null},simulation:{visible:!1,minimized:!1,expanded:!1,loading:!1,error:null},ml:{visible:!1,minimized:!1,expanded:!1,loading:!1,error:null},structural:{visible:!1,minimized:!1,expanded:!1,loading:!1,error:null},process:{visible:!1,minimized:!1,expanded:!1,loading:!1,error:null}}),P=c({language:"de",dateFormat:"DD.MM.YYYY",numberFormat:"de-DE",currency:"EUR",timezone:"Europe/Berlin",animationsEnabled:!0,soundEnabled:!1,highContrast:!1,reducedMotion:!1}),k=c({xs:480,sm:640,md:768,lg:1024,xl:1280,xxl:1536}),_=c({width:"undefined"!=typeof window?window.innerWidth:1024,height:"undefined"!=typeof window?window.innerHeight:768,isMobile:!1,isTablet:!1,isDesktop:!0}),z=v(()=>t.value),E=v(()=>({country:o.value,product:n.value,metric:r.value,year:i.value})),L=v(()=>"dark"===e.value||m.value),j=v(()=>_.value.width<k.value.md),F=v(()=>_.value.width>=k.value.md&&_.value.width<k.value.lg),A=v(()=>_.value.width>=k.value.lg),O=v(()=>Object.keys(I.value)),T=v(()=>Object.entries(I.value).filter(([e,a])=>a.visible).map(([e])=>e)),V=v(()=>Object.entries(I.value).filter(([e,a])=>a.expanded).map(([e])=>e)),R=v(()=>e=>{var a;return(null==(a=I.value[e])?void 0:a.visible)||!1}),Y=v(()=>e=>{var a;return(null==(a=I.value[e])?void 0:a.minimized)||!1}),$=v(()=>e=>{var a;return(null==(a=I.value[e])?void 0:a.expanded)||!1}),q=v(()=>e=>{var a;return(null==(a=I.value[e])?void 0:a.loading)||!1}),N=v(()=>e=>{var a;return(null==(a=I.value[e])?void 0:a.error)||null}),G=v(()=>h.value.length>0),U=v(()=>h.value.filter(e=>!e.read).length),W=v(()=>p.value||g.value.length>0||Object.values(I.value).some(e=>e.loading)),B=v(()=>Object.values(I.value).some(e=>e.error)),H=e=>{const a=h.value.findIndex(a=>a.id===e);a>-1&&h.value.splice(a,1)},Q=e=>{void 0!==e.country&&(o.value=e.country),void 0!==e.product&&(n.value=e.product),void 0!==e.metric&&(r.value=e.metric),void 0!==e.year&&(i.value=e.year)},J=()=>{"undefined"!=typeof window&&(_.value={width:window.innerWidth,height:window.innerHeight,isMobile:window.innerWidth<k.value.md,isTablet:window.innerWidth>=k.value.md&&window.innerWidth<k.value.lg,isDesktop:window.innerWidth>=k.value.lg},_.value.isMobile&&a.value&&(a.value=!1))};return"undefined"!=typeof window&&(J(),window.addEventListener("resize",J)),{theme:e,sidebarOpen:a,currentPanel:t,activePanel:l,selectedCountry:o,selectedProduct:n,selectedMetric:r,selectedYear:i,showAnalysisMenu:s,mapZoom:u,mapCenter:d,darkMode:m,notifications:h,loadingMessages:g,panelStates:I,loading:p,modals:f,tooltips:y,currentView:b,layoutMode:w,compactMode:x,showDebugInfo:D,navigationHistory:M,currentRoute:C,breadcrumbs:S,preferences:P,viewport:_,breakpoints:k,getCurrentPanel:z,getSelectedFilters:E,isDarkMode:L,isMobile:j,isTablet:F,isDesktop:A,availablePanels:O,visiblePanels:T,expandedPanels:V,isPanelVisible:R,isPanelMinimized:Y,isPanelExpanded:$,isPanelLoading:q,getPanelError:N,hasNotifications:G,unreadNotifications:U,isLoading:W,hasErrors:B,toggleSidebar:()=>{a.value=!a.value},setSidebarOpen:e=>{a.value=e},setCurrentPanel:e=>{t.value=e,I.value[e]&&(I.value[e].visible=!0,I.value[e].minimized=!1)},setActivePanel:e=>{O.value.includes(e)&&(l.value=e,t.value=e,M.value.push({panel:e,timestamp:new Date,path:C.value}),M.value.length>50&&(M.value=M.value.slice(-50)))},toggleAnalysisMenu:()=>{s.value=!s.value},setSelectedCountry:e=>{o.value=e},setSelectedProduct:e=>{n.value=e},setSelectedMetric:e=>{r.value=e},setSelectedYear:e=>{i.value=e},setMapView:(e,a)=>{u.value=e,d.value=a},toggleDarkMode:()=>{m.value=!m.value,m.value?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},toggleTheme:()=>{e.value="light"===e.value?"dark":"light",m.value="dark"===e.value,"undefined"!=typeof document&&document.documentElement.classList.toggle("dark",L.value)},setTheme:a=>{e.value=a,m.value="dark"===a,"undefined"!=typeof document&&document.documentElement.classList.toggle("dark",L.value)},showPanel:e=>{I.value[e]&&(I.value[e].visible=!0,I.value[e].minimized=!1,t.value=e)},hidePanel:e=>{I.value[e]&&(I.value[e].visible=!1)},togglePanel:e=>{I.value[e]&&(I.value[e].visible=!I.value[e].visible)},minimizePanel:e=>{I.value[e]&&(I.value[e].minimized=!0)},maximizePanel:e=>{I.value[e]&&(I.value[e].minimized=!1)},expandPanel:e=>{I.value[e]&&(I.value[e].expanded=!0)},collapsePanel:e=>{I.value[e]&&(I.value[e].expanded=!1)},setPanelLoading:(e,a)=>{I.value[e]&&(I.value[e].loading=a)},setPanelError:(e,a)=>{I.value[e]&&(I.value[e].error=a)},clearPanelError:e=>{I.value[e]&&(I.value[e].error=null)},addNotification:e=>{const a=Date.now()+Math.random(),t={id:a,type:"info",duration:5e3,...e};return h.value.push(t),t.duration>0&&setTimeout(()=>{H(a)},t.duration),a},removeNotification:H,clearNotifications:()=>{h.value=[]},addLoadingMessage:e=>{const a=Date.now()+Math.random();return g.value.push({id:a,message:e}),a},removeLoadingMessage:e=>{const a=g.value.findIndex(a=>a.id===e);a>-1&&g.value.splice(a,1)},clearLoadingMessages:()=>{g.value=[]},updateFilters:Q,resetUI:()=>{t.value="dashboard",o.value="",n.value="Wheat and products",r.value="production",i.value=2022,s.value=!1,u.value=1,d.value=[0,0],h.value=[],g.value=[],Object.keys(I.value).forEach(e=>{I.value[e]={visible:"dashboard"===e,minimized:!1}})},initializeUI:()=>{"true"===localStorage.getItem("darkMode")&&(m.value=!0,document.documentElement.classList.add("dark"));const e=localStorage.getItem("uiFilters");if(e)try{const a=JSON.parse(e);Q(a)}catch(a){}},savePreferences:()=>{localStorage.setItem("darkMode",m.value.toString()),localStorage.setItem("theme",e.value),localStorage.setItem("uiFilters",JSON.stringify(E.value)),localStorage.setItem("uiPreferences",JSON.stringify(P.value))},openModal:(e,a={})=>{f.value[e]={open:!0,config:a,timestamp:new Date}},closeModal:e=>{f.value[e]&&(f.value[e].open=!1)},isModalOpen:e=>{var a;return(null==(a=f.value[e])?void 0:a.open)||!1},showTooltip:(e,a)=>{y.value[e]={visible:!0,config:a,timestamp:new Date}},hideTooltip:e=>{y.value[e]&&(y.value[e].visible=!1)},setCurrentView:e=>{b.value=e},setLayoutMode:e=>{w.value=e},setCompactMode:e=>{x.value=e},updateViewport:J,setPreference:(e,a)=>{P.value.hasOwnProperty(e)&&(P.value[e]=a)},updateBreadcrumbs:e=>{S.value=e},setGlobalLoading:e=>{p.value=e}}}),_=e("visualization",()=>{const e=c(null),a=c(new Map),t=c(new Set),l=c(new Map),o=c([]),n=c(new Map),r=c(new Map),i=c(new Map),s=c(new Map),u=c({worldMap:{width:800,height:500,projection:"geoNaturalEarth1",colorScheme:"viridis",showLegend:!0,showTooltips:!0},timeseries:{width:600,height:400,margin:{top:20,right:30,bottom:40,left:40},lineColor:"#3b82f6",showPoints:!0,showGrid:!0},barChart:{width:500,height:300,margin:{top:20,right:30,bottom:40,left:60},colorScheme:"category10",orientation:"vertical"},scatterPlot:{width:500,height:400,margin:{top:20,right:30,bottom:40,left:40},pointSize:4,pointOpacity:.7},networkGraph:{width:700,height:500,linkDistance:100,nodeRadius:8,charge:-300,showLabels:!0},ml:{width:800,height:500,margin:{top:20,right:120,bottom:40,left:60},historicalColor:"#3b82f6",predictionColor:"#ef4444",confidenceColor:"#f59e0b"},simulation:{width:800,height:500,margin:{top:20,right:30,bottom:40,left:60},baselineColor:"#6b7280",scenarioColor:"#ef4444"},structural:{width:800,height:600,margin:{top:20,right:20,bottom:20,left:20},nodeColor:"#3b82f6",linkColor:"#6b7280",highlightColor:"#ef4444"},process:{width:800,height:500,margin:{top:40,right:40,bottom:40,left:40},primaryColor:"#3b82f6",secondaryColor:"#10b981",accentColor:"#f59e0b"}}),d=c({duration:750,ease:"d3.easeQuadInOut",enabled:!0}),m=c({production:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],forecast:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],trade:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],regions:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],analysis:["#3b82f6","#ef4444","#f59e0b","#10b981","#8b5cf6","#f97316","#06b6d4","#84cc16"],simulation:["#6b7280","#ef4444","#f59e0b","#10b981"],structural:["#3b82f6","#6b7280","#ef4444","#10b981"],process:["#3b82f6","#10b981","#f59e0b","#ef4444"],ml:["#3b82f6","#ef4444","#f59e0b"]}),h=c(new Map),g=c([]),p=c(!1),f=v(()=>e=>u.value[e]||{}),y=v(()=>e=>m.value[e]||m.value.production),b=v(()=>d.value.enabled),w=v(()=>e=>l.value.get(e)||{initialized:!1,data:null,error:null,lastUpdate:null}),x=v(()=>e=>n.value.get(e)||[]),D=v(()=>e=>r.value.get(e)||{}),M=v(()=>e=>i.value.get(e)||null),C=v(()=>e=>s.value.get(e)||{k:1,x:0,y:0}),S=v(()=>e=>t.value.has(e)),I=v(()=>e=>{const a=r.value.get(e)||{};return Object.keys(a).length>0}),P=v(()=>o.value.slice(-100)),k=e=>a.value.get(e),_=e=>{const t=a.value.get(e);t&&"function"==typeof t.destroy&&t.destroy(),a.value.delete(e)},z=(e,a)=>{u.value[e]&&(u.value[e]={...u.value[e],...a})},E=(e,a,t)=>{z(e,{width:a,height:t})},L=(e,a=1.6)=>{if(!e)return{width:800,height:500};const t=e.clientWidth,l=Math.max(300,t-40);return{width:l,height:Math.max(200,l/a)}},j=e=>{const a=document.createElement("canvas"),t=a.getContext("2d"),l=(new XMLSerializer).serializeToString(e),o=new Image;return new Promise((e,n)=>{o.onload=()=>{a.width=o.width,a.height=o.height,t.drawImage(o,0,0),e(a.toDataURL("image/png"))},o.onerror=n,o.src="data:image/svg+xml;base64,"+btoa(l)})},F=e=>{const a=(new XMLSerializer).serializeToString(e);return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a)},A=()=>{a.value.forEach((e,a)=>{_(a)}),e.value=null},O=(e,a)=>{l.value.set(e,{...w.value(e),...a,lastUpdate:new Date})},T=(e,a)=>{n.value.set(e,a),V(e,"selection",{elements:a})},V=(e,a,t={})=>{o.value.push({id:Date.now()+Math.random(),vizId:e,type:a,data:t,timestamp:new Date}),o.value.length>100&&(o.value=o.value.slice(-100))},R=async()=>{if(!p.value&&0!==g.value.length){for(p.value=!0,g.value.sort((e,a)=>{const t={high:0,normal:1,low:2};return t[e.priority]-t[a.priority]});g.value.length>0;){const a=g.value.shift();try{await a.updateFn()}catch(e){O(a.vizId,{error:e.message})}}p.value=!1}};return{mapInstance:e,chartInstances:a,visualizationConfigs:u,animationSettings:d,colorSchemes:m,activeVisualizations:t,visualizationStates:l,selectedElements:n,filters:r,brushSelections:i,zoomStates:s,interactionHistory:o,transformationCache:h,updateQueue:g,isUpdating:p,getVisualizationConfig:f,getColorScheme:y,isAnimationEnabled:b,getVisualizationState:w,getSelectedElements:x,getFilters:D,getBrushSelection:M,getZoomState:C,isVisualizationActive:S,hasActiveFilters:I,getInteractionHistory:P,setMapInstance:a=>{e.value=a},getMapInstance:()=>e.value,setChartInstance:(e,t)=>{a.value.set(e,t)},getChartInstance:k,removeChartInstance:_,updateVisualizationConfig:z,setAnimationSettings:e=>{d.value={...d.value,...e}},toggleAnimation:()=>{d.value.enabled=!d.value.enabled},updateMapConfig:e=>{z("worldMap",e)},setMapProjection:e=>{z("worldMap",{projection:e})},setMapColorScheme:e=>{z("worldMap",{colorScheme:e})},setMapDimensions:(e,a)=>{z("worldMap",{width:e,height:a})},updateChartConfig:(e,a)=>{z(e,a)},setChartDimensions:E,setChartMargin:(e,a)=>{z(e,{margin:a})},getResponsiveDimensions:L,updateResponsiveConfig:(e,a,t)=>{const{width:l,height:o}=L(a,t);return E(e,l,o),{width:l,height:o}},createColorScale:(e,a="production")=>{const t=y.value(a);return d3.scaleQuantize().domain(e).range(t)},createLinearScale:(e,a)=>d3.scaleLinear().domain(e).range(a),createTimeScale:(e,a)=>d3.scaleTime().domain(e).range(a),formatValue:(e,a="number")=>{if(null==e)return"N/A";switch(a){case"number":return d3.format(",.0f")(e);case"percentage":return d3.format(".1%")(e);case"currency":return d3.format("$,.0f")(e);case"compact":return d3.format(".2s")(e);default:return e.toString()}},exportVisualization:(e,a="png")=>{const t=k(e);if(!t)return null;const l=t.node?t.node():t;if(!l)return null;switch(a){case"png":return j(l);case"svg":return F(l);case"pdf":return exportToPDF(l);default:return null}},exportToPNG:j,exportToSVG:F,cleanup:A,resetToDefaults:()=>{A(),t.value.clear(),l.value.clear(),n.value.clear(),r.value.clear(),i.value.clear(),s.value.clear(),o.value=[],h.value.clear(),g.value=[],u.value={worldMap:{width:800,height:500,projection:"geoNaturalEarth1",colorScheme:"viridis",showLegend:!0,showTooltips:!0},timeseries:{width:600,height:400,margin:{top:20,right:30,bottom:40,left:40},lineColor:"#3b82f6",showPoints:!0,showGrid:!0},barChart:{width:500,height:300,margin:{top:20,right:30,bottom:40,left:60},colorScheme:"category10",orientation:"vertical"},scatterPlot:{width:500,height:400,margin:{top:20,right:30,bottom:40,left:40},pointSize:4,pointOpacity:.7},networkGraph:{width:700,height:500,linkDistance:100,nodeRadius:8,charge:-300,showLabels:!0},ml:{width:800,height:500,margin:{top:20,right:120,bottom:40,left:60},historicalColor:"#3b82f6",predictionColor:"#ef4444",confidenceColor:"#f59e0b"},simulation:{width:800,height:500,margin:{top:20,right:30,bottom:40,left:60},baselineColor:"#6b7280",scenarioColor:"#ef4444"},structural:{width:800,height:600,margin:{top:20,right:20,bottom:20,left:20},nodeColor:"#3b82f6",linkColor:"#6b7280",highlightColor:"#ef4444"},process:{width:800,height:500,margin:{top:40,right:40,bottom:40,left:40},primaryColor:"#3b82f6",secondaryColor:"#10b981",accentColor:"#f59e0b"}},d.value={duration:750,ease:"d3.easeQuadInOut",enabled:!0}},setVisualizationState:O,activateVisualization:e=>{t.value.add(e)},deactivateVisualization:e=>{t.value.delete(e)},setSelectedElements:T,addSelectedElement:(e,a)=>{const t=x.value(e);T(e,[...t,a])},removeSelectedElement:(e,a)=>{const t=x.value(e);T(e,t.filter(e=>e!==a))},clearSelection:e=>{n.value.set(e,[]),V(e,"clear_selection")},setFilter:(e,a,t)=>{const l=D.value(e);r.value.set(e,{...l,[a]:t}),V(e,"filter",{key:a,value:t})},removeFilter:(e,a)=>{const t=D.value(e),{[a]:l,...o}=t;r.value.set(e,o),V(e,"remove_filter",{key:a})},clearFilters:e=>{r.value.set(e,{}),V(e,"clear_filters")},setBrushSelection:(e,a)=>{i.value.set(e,a),V(e,"brush",{selection:a})},setZoomState:(e,a)=>{s.value.set(e,a),V(e,"zoom",{state:a})},recordInteraction:V,queueUpdate:(e,a,t="normal")=>{g.value.push({vizId:e,updateFn:a,priority:t,timestamp:Date.now()}),R()},processUpdateQueue:R,cacheTransformation:(e,a)=>{if(h.value.set(e,{data:a,timestamp:Date.now()}),h.value.size>100){const e=Array.from(h.value.entries());e.sort((e,a)=>e[1].timestamp-a[1].timestamp);e.slice(0,20).forEach(([e])=>h.value.delete(e))}},getCachedTransformation:e=>{const a=h.value.get(e);return a&&Date.now()-a.timestamp<3e5?a.data:null},clearCache:()=>{h.value.clear()}}});export{P as a,_ as b,k as u};
//# sourceMappingURL=stores-D-2ZrdBw.js.map

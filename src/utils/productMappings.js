/**
 * Product mappings for German translations and enhanced product selection
 * Maps English FAO product names to German names and provides additional metadata
 * Updated with exact FAO metadata product names (113 products total)
 */

export const productMappings = {
  // Cereals & Grains
  'Animal fats': 'Tierische Fette',
  'Barley and products': 'Gerste und Erzeugnisse',
  'Beer': 'Bier',
  'Cereals - Excluding Beer': 'Getreide - Ohne Bier',
  'Cereals, other': 'Getreide, andere',
  'Maize and products': 'Mais und Erzeugnisse',
  'Millet and products': 'Hirse und Erzeugnisse',
  'Oats': 'Hafer',
  'Rice and products': 'Reis und Erzeugnisse',
  'Rye and products': 'Roggen und Erzeugnisse',
  'Sorghum and products': 'Sorghum und Erzeugnisse',
  'Wheat and products': 'Weizen und Erzeugnisse',

  // Fruits
  'Apples and products': 'Äpfel und Erzeugnisse',
  'Bananas': 'Bananen',
  'Citrus, Other': 'Zitrusfrüchte, andere',
  'Dates': 'Datteln',
  'Fruits - Excluding Wine': 'Früchte - Ohne Wein',
  'Fruits, other': 'Früchte, andere',
  'Grapefruit and products': 'Grapefruit und Erzeugnisse',
  'Grapes and products (excl wine)': 'Trauben und Erzeugnisse (ohne Wein)',
  'Lemons, Limes and products': 'Zitronen, Limetten und Erzeugnisse',
  'Oranges, Mandarines': 'Orangen, Mandarinen',
  'Pineapples and products': 'Ananas und Erzeugnisse',

  // Vegetables & Roots
  'Cassava and products': 'Maniok und Erzeugnisse',
  'Onions': 'Zwiebeln',
  'Plantains': 'Kochbananen',
  'Potatoes and products': 'Kartoffeln und Erzeugnisse',
  'Roots, Other': 'Wurzeln, andere',
  'Starchy Roots': 'Stärkehaltige Wurzeln',
  'Sweet potatoes': 'Süßkartoffeln',
  'Tomatoes and products': 'Tomaten und Erzeugnisse',
  'Vegetables': 'Gemüse',
  'Vegetables, other': 'Gemüse, andere',
  'Yams': 'Yams',

  // Legumes & Nuts
  'Beans': 'Bohnen',
  'Groundnuts': 'Erdnüsse',
  'Nuts and products': 'Nüsse und Erzeugnisse',
  'Peas': 'Erbsen',
  'Pulses': 'Hülsenfrüchte',
  'Pulses, Other and products': 'Hülsenfrüchte, andere und Erzeugnisse',
  'Treenuts': 'Baumnüsse',

  // Meat & Animal Products
  'Bovine Meat': 'Rindfleisch',
  'Butter, Ghee': 'Butter, Ghee',
  'Cream': 'Sahne',
  'Eggs': 'Eier',
  'Meat': 'Fleisch',
  'Meat, Aquatic Mammals': 'Fleisch von Wassersäugetieren',
  'Meat, Other': 'Fleisch, andere',
  'Milk - Excluding Butter': 'Milch - Ohne Butter',
  'Mutton & Goat Meat': 'Hammel- und Ziegenfleisch',
  'Offals': 'Innereien',
  'Offals, Edible': 'Innereien, essbar',
  'Pigmeat': 'Schweinefleisch',
  'Poultry Meat': 'Geflügelfleisch',

  // Fish & Seafood
  'Aquatic Animals, Others': 'Wassertiere, andere',
  'Aquatic Plants': 'Wasserpflanzen',
  'Aquatic Products, Other': 'Wasserprodukte, andere',
  'Cephalopods': 'Kopffüßer',
  'Crustaceans': 'Krebstiere',
  'Demersal Fish': 'Bodenfische',
  'Fish, Body Oil': 'Fischkörperöl',
  'Fish, Liver Oil': 'Fischleberöl',
  'Fish, Seafood': 'Fisch, Meeresfrüchte',
  'Freshwater Fish': 'Süßwasserfische',
  'Marine Fish, Other': 'Meeresfische, andere',
  'Molluscs, Other': 'Weichtiere, andere',
  'Pelagic Fish': 'Pelagische Fische',

  // Oils & Fats
  'Coconut Oil': 'Kokosöl',
  'Cottonseed Oil': 'Baumwollsamenöl',
  'Fats, Animals, Raw': 'Tierische Fette, roh',
  'Groundnut Oil': 'Erdnussöl',
  'Maize Germ Oil': 'Maiskeimöl',
  'Oilcrops': 'Ölsaaten',
  'Oilcrops Oil, Other': 'Ölsaatenöl, andere',
  'Oilcrops, Other': 'Ölsaaten, andere',
  'Olive Oil': 'Olivenöl',
  'Olives (including preserved)': 'Oliven (einschließlich konservierte)',
  'Palm Oil': 'Palmöl',
  'Palmkernel Oil': 'Palmkernöl',
  'Rape and Mustard Oil': 'Raps- und Senföl',
  'Ricebran Oil': 'Reiskleieöl',
  'Sesameseed Oil': 'Sesamöl',
  'Soyabean Oil': 'Sojaöl',
  'Sunflowerseed Oil': 'Sonnenblumenöl',
  'Vegetable Oils': 'Pflanzenöle',

  // Seeds & Commodities
  'Cloves': 'Nelken',
  'Cocoa Beans and products': 'Kakaobohnen und Erzeugnisse',
  'Coffee and products': 'Kaffee und Erzeugnisse',
  'Cottonseed': 'Baumwollsamen',
  'Palm kernels': 'Palmkerne',
  'Pepper': 'Pfeffer',
  'Pimento': 'Piment',
  'Rape and Mustardseed': 'Raps- und Senfsamen',
  'Sesame seed': 'Sesamsamen',
  'Soyabeans': 'Sojabohnen',
  'Spices': 'Gewürze',
  'Spices, Other': 'Gewürze, andere',
  'Stimulants': 'Stimulanzien',
  'Sunflower seed': 'Sonnenblumenkerne',
  'Tea (including mate)': 'Tee (einschließlich Mate)',

  // Sugar & Sweeteners
  'Beverages, Fermented': 'Fermentierte Getränke',
  'Honey': 'Honig',
  'Sugar & Sweeteners': 'Zucker und Süßstoffe',
  'Sugar (Raw Equivalent)': 'Zucker (Rohzuckeräquivalent)',
  'Sugar Crops': 'Zuckerpflanzen',
  'Sugar beet': 'Zuckerrüben',
  'Sugar cane': 'Zuckerrohr',
  'Sugar non-centrifugal': 'Zucker, nicht zentrifugiert',
  'Sweeteners, Other': 'Süßstoffe, andere',
  'Wine': 'Wein',

  // Other Categories
  'Coconuts - Incl Copra': 'Kokosnüsse - Inkl. Kopra',
  'Infant food': 'Säuglingsnahrung',
  'Miscellaneous': 'Verschiedenes'
}

/**
 * Product categories for grouping and filtering
 */
export const productCategories = {
  'cereals': {
    name: 'Getreide und Körner',
    icon: '🌾',
    products: [
      'Barley and products', 'Beer', 'Cereals - Excluding Beer', 'Cereals, other',
      'Maize and products', 'Millet and products', 'Oats', 'Rice and products',
      'Rye and products', 'Sorghum and products', 'Wheat and products'
    ]
  },
  'fruits': {
    name: 'Früchte',
    icon: '🍎',
    products: [
      'Apples and products', 'Bananas', 'Citrus, Other', 'Dates',
      'Fruits - Excluding Wine', 'Fruits, other', 'Grapefruit and products',
      'Grapes and products (excl wine)', 'Lemons, Limes and products',
      'Oranges, Mandarines', 'Pineapples and products'
    ]
  },
  'vegetables': {
    name: 'Gemüse und Wurzeln',
    icon: '🥕',
    products: [
      'Cassava and products', 'Onions', 'Plantains', 'Potatoes and products',
      'Roots, Other', 'Starchy Roots', 'Sweet potatoes', 'Tomatoes and products',
      'Vegetables', 'Vegetables, other', 'Yams'
    ]
  },
  'legumes': {
    name: 'Hülsenfrüchte und Nüsse',
    icon: '🥜',
    products: [
      'Beans', 'Groundnuts', 'Nuts and products', 'Peas', 'Pulses',
      'Pulses, Other and products', 'Treenuts'
    ]
  },
  'meat': {
    name: 'Fleisch und Tierprodukte',
    icon: '🥩',
    products: [
      'Bovine Meat', 'Butter, Ghee', 'Cream', 'Eggs', 'Meat', 'Meat, Aquatic Mammals',
      'Meat, Other', 'Milk - Excluding Butter', 'Mutton & Goat Meat', 'Offals',
      'Offals, Edible', 'Pigmeat', 'Poultry Meat'
    ]
  },
  'seafood': {
    name: 'Fisch und Meeresfrüchte',
    icon: '🐟',
    products: [
      'Aquatic Animals, Others', 'Aquatic Plants', 'Aquatic Products, Other',
      'Cephalopods', 'Crustaceans', 'Demersal Fish', 'Fish, Body Oil',
      'Fish, Liver Oil', 'Fish, Seafood', 'Freshwater Fish', 'Marine Fish, Other',
      'Molluscs, Other', 'Pelagic Fish'
    ]
  },
  'oils': {
    name: 'Öle und Fette',
    icon: '🫒',
    products: [
      'Animal fats', 'Coconut Oil', 'Cottonseed Oil', 'Fats, Animals, Raw',
      'Groundnut Oil', 'Maize Germ Oil', 'Oilcrops', 'Oilcrops Oil, Other',
      'Oilcrops, Other', 'Olive Oil', 'Olives (including preserved)', 'Palm Oil',
      'Palmkernel Oil', 'Rape and Mustard Oil', 'Ricebran Oil', 'Sesameseed Oil',
      'Soyabean Oil', 'Sunflowerseed Oil', 'Vegetable Oils'
    ]
  },
  'seeds': {
    name: 'Samen und Rohstoffe',
    icon: '🌱',
    products: [
      'Cloves', 'Cocoa Beans and products', 'Coffee and products', 'Cottonseed',
      'Palm kernels', 'Pepper', 'Pimento', 'Rape and Mustardseed', 'Sesame seed',
      'Soyabeans', 'Spices', 'Spices, Other', 'Stimulants', 'Sunflower seed',
      'Tea (including mate)'
    ]
  },
  'sugar': {
    name: 'Zucker und Süßstoffe',
    icon: '🍯',
    products: [
      'Beverages, Fermented', 'Honey', 'Sugar & Sweeteners', 'Sugar (Raw Equivalent)',
      'Sugar Crops', 'Sugar beet', 'Sugar cane', 'Sugar non-centrifugal',
      'Sweeteners, Other', 'Wine'
    ]
  },
  'other': {
    name: 'Andere',
    icon: '📦',
    products: [
      'Coconuts - Incl Copra', 'Infant food', 'Miscellaneous'
    ]
  }
}

/**
 * Get German name for a product
 * @param {string} englishName - The English product name
 * @returns {string} The German product name or English name if not found
 */
export const getGermanName = (englishName) => {
  return productMappings[englishName] || englishName
}

/**
 * Get English name from German name
 * @param {string} germanName - The German product name
 * @returns {string} The English product name or German name if not found
 */
export const getEnglishName = (germanName) => {
  const entry = Object.entries(productMappings).find(([, german]) => german === germanName)
  return entry ? entry[0] : germanName
}

/**
 * Get category for a product
 * @param {string} productName - The product name (English)
 * @returns {string|null} The category key or null if not found
 */
export const getProductCategory = (productName) => {
  for (const [categoryKey, category] of Object.entries(productCategories)) {
    if (category.products.includes(productName)) {
      return categoryKey
    }
  }
  return 'other'
}

/**
 * Get all individual products with German names
 * @returns {Array} Array of product options with value and label
 */
export const getAllProductOptions = () => {
  return Object.keys(productMappings)
    .map(englishName => ({
      value: englishName,
      label: getGermanName(englishName),
      category: getProductCategory(englishName),
      categoryName: productCategories[getProductCategory(englishName)]?.name || 'Andere'
    }))
    .sort((a, b) => a.label.localeCompare(b.label, 'de'))
}

/**
 * Get products grouped by category
 * @returns {Object} Products grouped by category
 */
export const getProductsByCategory = () => {
  const grouped = {}
  
  for (const [categoryKey, category] of Object.entries(productCategories)) {
    grouped[categoryKey] = {
      ...category,
      products: category.products
        .map(englishName => ({
          value: englishName,
          label: getGermanName(englishName)
        }))
        .sort((a, b) => a.label.localeCompare(b.label, 'de'))
    }
  }
  
  return grouped
}

/**
 * Search products by German or English name
 * @param {string} searchTerm - The search term
 * @returns {Array} Matching product options
 */
export const searchProducts = (searchTerm) => {
  if (!searchTerm || searchTerm.length < 2) {
    return getAllProductOptions()
  }
  
  const term = searchTerm.toLowerCase()
  
  return getAllProductOptions().filter(product => 
    product.label.toLowerCase().includes(term) ||
    product.value.toLowerCase().includes(term)
  )
}